<div class="p-6 max-w-4xl mx-auto">
  <h2 class="text-2xl font-bold mb-4">Clean Your Email List</h2>

  <div
    class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
  >
    <input type="file" accept=".csv,.txt" (change)="onFileSelected($event)" hidden #fileInput>
    <div (click)="fileInput.click()">
      <i class="fas fa-upload text-4xl text-gray-400 mb-2"></i>
      <p class="text-gray-600">Drag and drop your CSV or TXT file here, or click to browse</p>
    </div>
  </div>

  <div *ngIf="selectedFile" class="mt-4 p-4 bg-white rounded shadow">
    <div class="flex justify-between items-center">
      <p><strong>Selected File:</strong> {{ selectedFile.name }} ({{ formatFileSize(selectedFile.size) }})</p>
      <button (click)="selectedFile = null; resetState()" class="text-gray-400 hover:text-red-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <button
    class="mt-4 bg-primary text-white px-6 py-2 rounded shadow hover:bg-indigo-600 disabled:opacity-50"
    (click)="onSubmit()"
    [disabled]="!selectedFile"
  >
    <i class="fas fa-broom mr-2"></i>
    Clean My Email List
  </button>

  <div *ngIf="errorMessage" class="mt-4 text-red-600">
    {{ errorMessage }}
  </div>

  <div *ngIf="results.length > 0" class="mt-6">
    <h3 class="text-xl font-semibold mb-2">Results</h3>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-green-100 p-4 rounded">
        <h4 class="font-semibold text-green-700">Valid Emails ({{ validEmails.length }})</h4>
        <ul class="mt-2 max-h-40 overflow-auto text-sm text-green-800">
          <li *ngFor="let email of validEmails">{{ email.email }}</li>
        </ul>
        <button class="mt-2 text-green-600 underline" (click)="downloadCategory('valid')">Download</button>
      </div>

      <div class="bg-yellow-100 p-4 rounded">
        <h4 class="font-semibold text-yellow-700">Risky Emails ({{ riskyEmails.length }})</h4>
        <ul class="mt-2 max-h-40 overflow-auto text-sm text-yellow-800">
          <li *ngFor="let email of riskyEmails">{{ email.email }}</li>
        </ul>
        <button class="mt-2 text-yellow-600 underline" (click)="downloadCategory('risky')">Download</button>
      </div>

      <div class="bg-red-100 p-4 rounded">
        <h4 class="font-semibold text-red-700">Bounce Emails ({{ bounceEmails.length }})</h4>
        <ul class="mt-2 max-h-40 overflow-auto text-sm text-red-800">
          <li *ngFor="let email of bounceEmails">{{ email.email }}</li>
        </ul>
        <button class="mt-2 text-red-600 underline" (click)="downloadCategory('bounce')">Download</button>
      </div>
    </div>
  </div>
</div>
